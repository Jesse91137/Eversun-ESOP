# E-SOP 電子標準作業程序系統

## 專案概述

E-SOP是一套電子標準作業程序管理系統，專為生產製造環境設計，旨在數位化及優化標準作業程序(SOP)文件的管理與查詢流程。系統提供友好的使用者介面，讓使用者能快速查詢、檢視及使用相關的SOP文件。本系統協助製造單位標準化生產流程，提高生產效率，並確保產品品質的一致性。

## 功能特點

- **SOP文件查詢**：透過工單號碼、產品型號或製程代碼快速查詢相關SOP文件
- **多製程支援**：支援多種製造製程的SOP文件管理
- **生產通知整合**：查看與SOP相關的生產通知單
- **版本控制**：追蹤並管理SOP文件的版本
- **PDF檢視**：直接在應用程式中檢視PDF格式的SOP文件
- **FTP整合**：支援從FTP伺服器下載最新SOP文件
- **維修記錄管理**：追蹤設備維修歷史和狀態
- **使用權限控制**：基於角色的權限管理系統
- **操作日誌**：記錄系統操作歷史，便於追蹤和稽核
- **資料庫整合**：與企業資料庫系統無縫連接，確保資料一致性

## 系統需求

- 作業系統：Windows 7 或更高版本
- .NET Framework：4.5或更高版本
- 硬碟空間：至少200MB可用空間
- 記憶體：最低2GB RAM，建議4GB或以上
- 處理器：Intel Core i3 或同等級以上
- 螢幕解析度：最低1280x720
- 其他需求：網路連線（用於FTP存取及資料庫連線）
- 資料庫：支援MS SQL Server 2012或更高版本

## 安裝指南

1. 確保系統符合上述系統需求
2. 執行安裝檔 `Setup.exe`
3. 依照安裝精靈的指示完成安裝
4. 首次啟動時，設定資料庫連線參數
5. 設定FTP伺服器連線資訊
6. 完成初始化設定後，系統即可正常使用

## 使用說明

### 基本操作流程

1. 啟動應用程式
2. 選擇適合的製程（下拉選單）
3. 輸入工單號碼或產品型號進行查詢
4. 從搜尋結果中選擇需要的SOP文件
5. 系統將自動下載並開啟選定的SOP文件

### 主要功能介紹

- **製程選擇**：從下拉式選單中選擇相關製程
- **工單查詢**：輸入工單號碼後按下查詢按鈕
- **SOP檢視**：雙擊清單中的SOP項目，即可開啟檢視
- **生產通知**：點擊生產通知按鈕檢視相關通知單
- **清空功能**：使用清空按鈕重置所有輸入欄位
- **維修記錄**：查看和管理設備維修歷史記錄
- **使用者管理**：管理員可設定使用者權限和角色
- **系統設定**：調整系統參數和連線設定
- **資料匯出**：將查詢結果匯出為Excel或PDF格式

## 配置說明

系統配置保存在 `Setup.ini` 檔案中，包含以下設定：

- FTP伺服器連線資訊
- 預設製程設定
- 檔案下載路徑設定
- 資料庫連線字串
- 使用者介面設定
- 日誌記錄設定
- 系統備份設定

管理員可透過系統設定介面修改這些配置，無需直接編輯配置檔案。

## 疑難排解

常見問題：

1. **無法連接至FTP伺服器**
   - 檢查網路連線是否正常
   - 確認FTP伺服器設定是否正確
   - 檢查防火牆設定是否允許FTP連線

2. **找不到SOP文件**
   - 確認工單號碼或產品型號輸入正確
   - 確認所選製程類別正確
   - 檢查資料庫連線是否正常

3. **無法開啟PDF文件**
   - 確認系統已安裝PDF閱讀器
   - 檢查檔案是否已下載完成
   - 確認檔案格式是否正確

4. **系統運行緩慢**
   - 檢查系統資源使用情況
   - 確認資料庫連線效能
   - 考慮清理暫存檔案

5. **資料庫連線錯誤**
   - 確認資料庫伺服器是否運行
   - 檢查連線字串設定
   - 確認資料庫帳號權限

---

## 主要程式邏輯說明

### SOP 文件雙擊開啟與維修統計視窗顯示

- 使用者於 SOP 文件列表（listBox1）雙擊檔案名稱時，會觸發 `listBox1_DoubleClick` 事件。
- 程式根據檔案名稱及作業模式，判斷檔案路徑與所屬資料夾，組合出完整檔案路徑。
- 特殊文件（如 EM 開頭或包含 SERVICE）直接使用預設路徑，其餘依工單或工程編號組合路徑。
- 檔案會先複製到臨時目錄，再以系統預設程式（如 PDF 閱讀器）開啟。
- 在開啟檔案前，系統會自動查詢該檔案對應的維修統計資料，並以新視窗（TopMost=true，顯示最上層）顯示維修統計表格，避免被其他視窗擋住。
- 維修統計表格顯示「不良日期」、「責任單位」、「維修料號」、「維修位置」、「不良描述」、「備註」等資訊，方便維修追蹤與管理。

#### 主要方法說明

- `listBox1_DoubleClick`
  - 處理 SOP 檔案開啟邏輯，並呼叫維修統計查詢與顯示。
  - 依不同情境（生產通知單、無工程編號、特殊文件、一般文件）組合檔案路徑。
  - 先顯示維修統計視窗，再開啟檔案，確保統計視窗不會被其他應用程式蓋住。

- `ShowRepairRecordsForm`
  - 以 DataGridView 顯示維修統計查詢結果，並設定 TopMost=true。
  - 標題顯示機種名稱，欄位名稱以中文顯示，方便現場人員閱讀。
  - 若查詢無資料則不會顯示視窗。

- `DetermineResponsibilityUnit`
  - 根據檔案名稱查詢資料庫，取得對應的責任單位。

- `QueryRepairRecords`
  - 依據機種名稱與責任單位查詢維修統計資料。

---

## 更新與維護

系統具備自動更新功能，會在啟動時檢查可用更新。當有更新可用時，系統將提示用戶更新至最新版本。

### 定期維護建議

- **資料庫備份**：建議每週進行一次完整資料庫備份
- **日誌清理**：每月清理過期系統日誌
- **暫存檔案清理**：定期清理下載暫存區，釋放磁碟空間
- **系統檢查**：每季進行一次系統健康檢查，確保所有功能正常運作

## 聯絡支援

如遇到任何問題，請聯絡系統管理員或IT支援人員獲取協助。

**技術支援聯絡方式**：
- 電子郵件：support@eversun.com.tw
- 內線電話：分機8888
- 服務時間：週一至週五 08:30-17:30

## 開發團隊

本系統由Eversun Technology研發團隊開發與維護，致力於提供高品質的製造執行系統解決方案。

---

© 2025 Eversun Technology. 版權所有。
